> 데이터셋이 매우 크거나 질의 처리량이 매우 높다면 복제만으로는 부족하고 데이터를 `파티션`으로 쪼갤 필요가 있다.  
> 이 작업을 `샤딩`이라고 한다.

**각 DB에서 파티션을 지칭하는 용어**

| 샤드(shard) | 몽고DB, 엘라스틱서치, 솔라클라우드 |
| --- | --- |
| 리전(region) | HBase |
| 태블릿(tablet) | 빅테이블 |
| 브이노드(vnode) | 카산드라, 리악 |
| 브이버켓(vBucket) | 카우치베이스 |

<br>

**[개념 사전]**

| 단어 | 설명 |
| --- | --- |
| 파티셔닝 | 대용량 데이터베이스를 의도적으로 작은 단위로 쪼개는 방법 |

<br>

## 새롭게 알게된 점(NEW)

### 파티셔닝

> 파티션을 나눌 때는 보통 각 데이터 단위(레코드, 로우, 문서)가 하나의 파티션에 속하게 된다. 데이터가 여러 파티션을 동시에 건드리는 연산을 지원할 수도 있지만 결과적으로 각 파티션은 그 자체로 작은 데이터베이스가 된다.
> 
> ***파티셔닝을 하는***  
> 💡 **주된 이유** : `확장성`  
> 💡 **목적** : 데이터와 질의 부하를 노드 사이에 고르게 `분산`시키는 것

| 표현 | 의미 |
| --- | --- |
| 쏠렸다(skewed) | 파티셔닝이 고르게 이뤄지지 않아 다른 파티션보다 데이터가 많거나 질의를 많이 받는 파티션이 생기는 현상 |
| 핫스팟 | 불균형하게 부하가 높은 파티션 |
- 대용량 데이터셋이 여러 디스크에 분산될 수도 있고 질의 부하는 여러 프로세서에 분산될 수 있다.
- 각 노드에서 자신의 파티션에 해당하는 질의를 독립적으로 실행할 수 있으므로 노드를 추가하면 `질의 처리량`을 늘릴 수 있다.
- 어떤 한 파티션에 속한 레코드를 여러 다른 노드에 저장해서 `내결함성`을 보장할 수 있다.
- **핫스팟을 회피하는 방법**
    - 레코드를 할당할 노드를 무작위로 선택하면 고르게 분산된다. **but,** 모든 노드에 병렬적으로 질의를 실행해야 한다.
    - 키-값 데이터 모델을 사용해 기본키를 통해 레코드에 접근한다. 모든 항목이 알파벳 순으로 정렬되어 있다.

<br>

**[1] 종류**

|  | **범위 기준**                                                     | 키 기준 |
| --- |---------------------------------------------------------------| --- |
| 방법 | 각 파티션의 연속된 범위의 키를 할당하며, 정렬된 순서로 저장할 수 있다.                     | 해시 함수를 사용해 키를 할당하여 쏠림과 핫스팟 유발을 방지한다. |
| 장점 | - 범위 스캔이 쉬워진다.<br>- 키를 연쇄된 색인으로 간주해 질의 하나로 관련 레코드 여러 개를 읽어온다. | 키를 파티션 사이에 균일하게 분산시킨다.
|
| 단점 | 연속된 레코드에 접근할 시 핫스팟을 유발할 수 있다.                                 | 범위 질의를 모든 파티션에 전송해야 한다. |
| 특징 | 데이터를 고르게 분산시키려면 파티션 경계를 데이터에 맞춰 조정해야 한다.                      | 파티션 경계는 크기가 동일하도록 나눌 수도 있고 무작위에 가깝게 선택할 수도 있다. |